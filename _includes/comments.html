<!-- taken from https://github.com/g-leech/argmin-gravitas/blob/77e179941a61f54565ce3d88d5e304d1908982e4/_includes/comments.html -->
<!-- modified to be one big form with a value for slug -->
<!-- this slug is maybe wrong or at least inconsistent with some other things -->
{% assign slug = page.title | slugify %}


<div class="accordion">
        <h3>Comments ({{site.data.comments[slug] | size}})</h3>
  <div>

  {% if site.data.comments[slug] %}
    {% assign comments = site.data.comments[slug] | sort %}

    {% for comment in comments %}
      <br>
      <p><b>{{ comment[1].author_name }}</b> </p>
      <p><em>{{ comment[1].timestamp | date: "%B %d %Y" }}</em></p>
      <p>{{ comment[1].comment_text | markdownify }}</p>
      <hr>
    {% endfor %}
  {% endif %}

  <div style="padding:20px; padding-bottom: 80px; text-align: center;">
  <big>Post a comment:</big><br><br>

    <form name="comments" netlify>
            <p> <input type="text" name="slug" value="{{slug}}" hidden="true"></p>
      <p>
        <label>Name <input type="text" name="name" /></label>
      </p>
      <p>
        <label>Email <input type="email" name="email" /></label>
      </p>
      <p>
        <span style="font-color:gray">
          <small>Comments appear after moderation. You can use html or markdown.<br>
          Page just refreshes after successful submit.</small>
        </span>
      </p>
      <p>
        <label><textarea name="message" cols="30" rows="6"></textarea></label>
      </p>
      <p>
        <button type="submit">Send</button>
      </p>
    </form>

  </div>
  
  </div>
</div>
